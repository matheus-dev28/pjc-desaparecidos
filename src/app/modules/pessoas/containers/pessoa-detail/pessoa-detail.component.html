<section class="bg-gray-100 min-h-screen">
<div *ngIf="pessoa$ | async as p; else carregando" class="w-full max-w-[1200px] 2xl:max-w-[1440px] mx-auto py-8 px-4">
  <div class="flex items-center justify-between mb-4">
    <a mat-button [routerLink]="['/']">
      <mat-icon>arrow_back</mat-icon>
      VOLTAR
    </a>
  </div>

    <div class="grid grid-cols-1 md:grid-cols-[340px_1fr] gap-6 items-start p-4">
      <!-- Foto -->
      <div class="relative">
        <img
          [src]="foto(p)"
          alt="{{ p.nome }}"
          class="w-full md:w-[320px] h-[450px] object-cover border rounded-lg shadow"
          loading="lazy"
          decoding="async"
          (error)="onImgError($event)"
        />
      </div>

      <!-- Informações -->
      <div>
        <div class="flex flex-col items-start gap-3">
          <span
            class="px-3 py-1 rounded-lg text-white text-sm font-bold"
            [class.bg-red-600]="status(p)==='DESAPARECIDO'"
            [class.bg-green-600]="status(p)==='LOCALIZADO'">
            {{ statusLabel(p) }}
          </span>
          <span class="text-2xl md:text-4xl font-bold text-gray-950 uppercase tracking-wide">
            {{ p.nome }}
          </span>
        </div>

        <div class="text-base text-gray-700 mb-3">
          <span *ngIf="p.idade !== undefined">{{ p.idade }} anos</span>
          <span *ngIf="p.idade !== undefined && sexoLegivel(p)"> - </span>
          <span *ngIf="sexoLegivel(p)">{{ sexoLegivel(p) }}</span>
        </div>

        <hr class="my-2 border-gray-300" />

        <div class="mt-4">
          <div class="text-lg font-semibold mb-2">Dados sobre o Desaparecimento</div>

          <div class="text-md text-gray-800 mb-1">
            <span class="font-semibold">Data:</span>
            {{ p.ultimaOcorrencia?.dtDesaparecimento | date:'dd/MM/yyyy, HH:mm' }}
          </div>

          <div class="text-md text-gray-800 mb-1">
            <span class="font-semibold">Local:</span>
            {{ p.ultimaOcorrencia?.localDesaparecimentoConcat || 'Não informado' }}
          </div>

          <div class="text-sm text-gray-800 mb-1" >
            <span class="font-semibold">Vestimenta:</span>
            {{p.ultimaOcorrencia?.ocorrenciaEntrevDesapDTO?.vestimentasDesaparecido || 'Não informado'}}
          </div>

          <div class="text-sm text-gray-800 mb-2">
            <span class="font-semibold">Informações adicionais:</span>
            {{p.ultimaOcorrencia?.ocorrenciaEntrevDesapDTO?.informacao || 'Sem informações adicionais'}}
          </div>

          <div
            class="mt-2 font-extrabold uppercase"
            [class.text-red-600]="status(p)==='DESAPARECIDO'"
            [class.text-green-700]="status(p)==='LOCALIZADO'">
            {{ diasTexto(p) }}
          </div>

          <div class="mt-4">
            <a mat-flat-button
               [color]="status(p)==='DESAPARECIDO' ? 'warn' : 'primary'"
               class="text-white"
               (click)="abrirFormulario(p)">
              <mat-icon>campaign</mat-icon>
              VIU OU SABE DESSA PESSOA?
            </a>
          </div>
        </div>

        <div class="mt-6">
          <div class="font-semibold mb-2">Ajude compartilhando:</div>
          <div class="flex flex-wrap gap-3">
            <div class="flex items-center bg-gray-900 rounded-full px-4 py-2 gap-2">
                <img src="assets/icon/whatsapp.png" alt="" class="w-5 h-5"/>
                <a
                  [href]="whatsappShare(p)"
                  class="text-white text-sm"
                  target="_blank"
                  rel="noopener"
                >
                    COMPARTILHE PELO WHATSAPP
                </a>
            </div>
            <div class="flex items-center bg-gray-900 rounded-full px-4 py-2 gap-2" *ngIf="cartazInsta(p) as insta">
                <img src="assets/icon/instagram.png" alt="" class="w-5 h-5"/>
                <a
                  class="text-white text-sm"
                  [href]="insta"
                  target="_blank"
                  rel="noopener"
                  download
                  >
                  BAIXE O CARTAZ PARA INSTAGRAM
                </a>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

<ng-template #carregando>
  <div class="w-full max-w-[1200px] 2xl:max-w-[1440px] mx-auto p-6 md:p-8">
    Carregando detalhes...
  </div>
</ng-template>
</section>